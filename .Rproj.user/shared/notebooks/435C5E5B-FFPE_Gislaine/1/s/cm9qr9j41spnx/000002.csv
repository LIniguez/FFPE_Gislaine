"0","read_multiple<-function(x, name, col){"
"0","  lapply(lfile, function(x) {"
"0","    z <-read.delim(x,header=T,skip=0)[,col]"
"0","    colnames(z)<-c(name,strsplit(strsplit(x,split=""/"")[[1]][9],split=""_htseq"",fixed=T)[[1]][1])"
"0","    z"
"0","  })}   #this function is for reading multiple files"
"0","lfile<-list.files(path = ""/Users/luis_iniguez/Documents/WCM/FFPE_Brazil/"",pattern='*_htseq.txt', recursive=T) #find all files with that name"
"0","lfile<-paste0(""/Users/luis_iniguez/Documents/WCM/FFPE_Brazil/"",lfile)"
"0","datatemp <- read_multiple(lfile, name=""Gene"", col=c(1,2)) # Read the file and extract the column 3 is for final_count and 4 the final_conf"
"0","datos<-Reduce(function(x,y) {merge(x,y, by=""Gene"", all=T)}, datatemp) #merge all tables into a single one"
"0","datos[is.na(datos)]<-0"
"0","datos<-datos[-grep(datos$Gene, pattern=""__""),]"
"0","file1<-paste0(""Gene_table_Gislaine.txt"")"
"0","write.table(datos, file=file1, quote=F, sep='\t', row.names=F)"
